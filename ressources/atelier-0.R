################################################################################
#### Introduction à l'actuariat II - Hiver 2026 ################################
#### École d'actuariat - Université Laval ######################################
################################################################################

################################################################################
### Partie I - Lois discrètes ##################################################
################################################################################

# Fonction de masse de probabilité
x <- 0:10
fx <- c(0.1, 0.05, 0.11, 0.15, 0.17, 0.08, 0.1, 0.05, 0.09, 0.05, 0.05)

# Espérance
EspX <- sum(x * fx)
EspX

# Variance
VarX <- sum((x - EspX)^2 * fx)
VarX

# Fonction de répartition
Fx <- cumsum(fx)
Fx

# Espérance limitée
EspLim <- function(d) sum(pmin(x, d) * fx)
EspLim(5)

# Espérance tronquée
EspTr <- function(d) sum(x * fx * I(x > d))
EspTr(5)


################################################################################
### Partie II - Lois connues #################################################
################################################################################

### Loi Gamma ##################################################################

al <- 2
be <- 0.01

# Fonction de répartition
pgamma(c(0, 50, 100), al, be)

# Fonction de densité
dgamma(c(0, 50, 100), al, be)

# Fonction quantile
qgamma(c(0, 0.5, 0.9), al, be)


### Loi Poisson ################################################################

lam <- 3

# Fonction de répartition
ppois(c(0, 5, 10), lam)

# Fonction de densité
dpois(c(0, 5, 10), lam)

# Fonction quantile
qpois(c(0, 0.5, 0.9), lam)


################################################################################
### Partie III - Optimisation numérique ########################################
################################################################################

### Optimize ###################################################################

f <- function (x, a) (x - a)^2
(xmin <- optimize(f, c(0, 1), a = 1/3))


### Uniroot ####################################################################

f <- function (x, a) x - a
(xmin <- uniroot(f, c(0, 1), a = 1/3))
